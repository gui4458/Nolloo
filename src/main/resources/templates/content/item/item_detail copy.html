<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{fragment/user_layout}">

<th:block layout:fragment="content_css">
    <!-- html 파일이 열릴때 같이 실행되는 css -->
    <link rel="stylesheet" href="/css/board/board_detail.css">
</th:block>

<th:block layout:fragment="contentFragment">
    <!-- html 코드작성-->

    <div x-data="{showModal:false}">
        <!-- dialog를 오픈하는 버튼 -->
        <button
            class="inline-flex justify-center rounded-md bg-indigo-600 px-3 py-1 text-sm font-semibold text-white shadow-lg ml-3 w-[120px] hover:bg-indigo-700"
            type="button" @click="showModal=true">Open Modal</button>

        <!-- dialog 시작 , 여기는 dialog 오픈 시 배경이 검해지는 부분 -->
        <div class="fixed inset-0 z-30 flex items-center justify-center overflow-auto bg-black bg-opacity-50"
            x-show="showModal" x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
            x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">

            <!-- 찐 dialog 시작 부분 -->
            <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all my-8 w-full max-w-lg"
                x-show="showModal" x-transition:enter="ease-out duration-300"
                x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
                x-transition:leave="ease-in duration-200"
                x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
                x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                @click.outside="showModal=false">

                <!-- dialog body -->
                <div class="bg-white p-6">
                    <h1 class="font-bold text-lg mb-2">Deactivate account</h1>
                    <p class="text-sm text-gray-500">
                        <!-------- 메인이미지 ------->
                    <div class="main-img-div">
                        <span>
                            <th:block th:if="${item.cateCode == 1}">
                                <th:block th:each="img : ${item.imgList}">
                                    <th:block th:if="${img.isMain=='Y'}">
                                        <div class="img-div"
                                            th:style="'background-image:url(/upload/itemSolo/' + ${img.attachedFileName} + ');background-repeat:no-repeat;'">
                                        </div>
                                    </th:block>
                                </th:block>
                            </th:block>
                        </span>
                        <span>
                            <th:block th:if="${item.cateCode == 2}">
                                <th:block th:each="img : ${item.imgList}">
                                    <th:block th:if="${img.isMain=='Y'}">
                                        <div class="img-div"
                                            th:style="'background-image:url(/upload/item/' + ${img.attachedFileName} + ');background-repeat:no-repeat;'">
                                        </div>

                                    </th:block>
                                </th:block>
                            </th:block>
                        </span>
                    </div>

                    <!------------- 개최자 ----------->
                    <div class="py-4 px-4 border-slate-100 bg-white shadow-xl shadow-slate-900/5 rounded-lg">
                        <div class="id-div font-size: 1.125rem;">
                            [[${item.memberId}]]
                        </div>

                        <!------------- 장소 ----------->

                        <div style="font-size: 15px;">
                            <!-- 동만 나오게 설정 예정 -->
                            [[${item.itemPlace}]]
                        </div>

                    </div>
                    <!------------ 제목 ---------->

                    <div class="drop-shadow-lg text-3xl font-semibold">
                        [[${item.itemTitle}]]
                    </div>
                    <!---------- 올린시간 --------->
                    <div class="row-mb-3 ">
                        <div class="col date-div">
                            [[${item.itemStartDate}]]~[[${item.itemEndDate}]]
                        </div>
                    </div>
                    <!--------------------- 상세이미지  ------------------------->
                    <div class="grid grid-cols-3 gap-4">
                        <th:block th:if="${item.cateCode == 1}">
                            <span class="flex flex-row p-4">
                                <th:block th:each="img : ${item.imgList}">
                                    <th:block th:if="${img.isMain=='N'}">
                                        <div class="lg:w-full ml-5 lg:ml-2 ">
                                            <img th:src="@{'/upload/itemSolo/'+${img.attachedFileName}}"
                                                class="sub-img-div lg:rounded-lg " alt="">
                                        </div>
                                    </th:block>
                                </th:block>
                            </span>
                        </th:block>
                        <th:block th:if="${item.cateCode == 2}">
                            <span class="flex flex-row p-4">
                                <th:block th:each="img : ${item.imgList}">
                                    <th:block th:if="${img.isMain=='N'}">
                                        <div class="lg:w-full ml-5 lg:ml-2">
                                            <img th:src="@{'/upload/item/'+${img.attachedFileName}}"
                                                class="sub-img-div lg:rounded-lg" alt="">
                                        </div>
                                    </th:block>
                                </th:block>
                            </span>
                        </th:block>
                    </div>
                    <!------------ 내용 ------------>
                    <div class="py-4 px-4 border-slate-100 bg-white shadow-xl shadow-slate-900/5 rounded-lg ">
                        <p class="h-80 text-lg  size-full align-top list-disc px-3">
                            [[${item.itemContent}]]
                        </p>
                    </div>

                    </p>
                </div>

                <!-- dialog footer -->
                <div class="flex gap-3 justify-end bg-gray-50 px-4 py-2">
                    <button type="button"
                        class="inline-flex justify-center rounded-md bg-red-600 px-3 py-1 text-sm font-semibold text-white shadow-sm hover:bg-red-500 ml-3 w-auto"></button>
                    <button @click="showModal=false" type="button"
                        class="inline-flex justify-center rounded-md bg-white px-3 py-1 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 mt-0 w-auto">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="space-y-6 mr-10 mx-20 px-40 ">











        

        


        <!------------- 조회수 ------------>

        <div>
            [[${item.readCnt}]]/
            <span sec:authorize="isAuthenticated()" th:onclick="goChat([[${item.itemCode}]])">채팅바로가기</span>
            <span sec:authorize="isAnonymous()" onclick="goLogin()">채팅바로가기</span>
        </div>


        <!------------- 위치 ------------>

        <div>
            위치/지도
        </div>
        <input type="hidden" id="itemX" name="itemX" th:value="${item.itemX}">
        <input type="hidden" id="itemY" name="itemY" th:value="${item.itemY}">

        <div id="map" style="width:100%;height:600px;"></div>


        <!------------ 버튼 -------------->
        <div class="grid grid-cols-6 divide-x pb-14">
            <div class="">
                <button type="button" th:if="${reserveCnt == 0}" th:onclick="reserveInsert([[${item.itemCode}]])"
                    class="bg-red-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                    참여</button>
                <button type="button" th:if="${reserveCnt != 0}" th:onclick="reserveAlert([[${item.itemCode}]])"
                    class="bg-red-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                    참여</button>
            </div>

            <!-- 글 올린사람이 마감 올릴 수 있게 마감된 게시글 -->
            <div class="">
                <button type="button" onclick="deadline()"
                    class="bg-red-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                    마감</button>
            </div>

            <div class="">
                <button type="button" th:onclick="|location.href='@{/item/updateForm(itemCode=${item.itemCode})}'|"
                    class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                    수정</button>
            </div>
            <div class="">
                <button type="button" th:onclick="|location.href='@{/item/deleteItem(itemCode=${item.itemCode})}'|"
                    class="bg-red-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                    삭제</button>
            </div>
            <div class="">
                <button type="button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                    목록</button>
            </div>
            <div class="">
                <button type="button" th:onclick="goWish([[${item.itemCode}]],[[${#authentication.name}]])"
                    class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full">
                    찜</button>
            </div>
        </div>
    </div>



</th:block>

<script>
    var itemX = document.getElementById("itemX").value;
    var itemY = document.getElementById("itemY").value;
</script>

<th:block layout:fragment="content_js">
    <!-- html 파일이 열릴때 같이 실행되는 js -->
    <script src="/js/content/item/item_detail.js"></script>
    <!-- 3f269d19617ad795568529a85a77081a -->
    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=3f269d19617ad795568529a85a77081a "></script>
    <script src="/js/position.js"></script>

</th:block>

</html>